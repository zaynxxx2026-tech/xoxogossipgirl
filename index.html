<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>xoxo gossip girl</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
<link rel="stylesheet" href="https://fonts.cdnfonts.com/css/sf-pro-display">
<style>
:root { --pink: #ff4fd8; --hot: #ff1aa6; --glass: rgba(255, 255, 255, 0.06); --border: rgba(255, 255, 255, 0.15); }
* { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; font-family: 'SF Pro Display', 'SF Arabic', sans-serif; }
body { background: #000; color: #fff; background-image: radial-gradient(circle at 50% 0%, #1a0f33 0%, #000 70%); background-attachment: fixed; overflow-x: hidden; }

/* --- iOS LIQUID GLASS STYLE --- */
header { 
    position: sticky; top: 0; z-index: 1000; padding: 25px 20px;
    background: rgba(10, 10, 10, 0.6); backdrop-filter: blur(50px) saturate(200%); -webkit-backdrop-filter: blur(50px) saturate(200%);
    border-bottom: 0.5px solid var(--border); display: flex; flex-direction: column; align-items: center;
}
.logo { font-size: 32px; font-weight: 900; letter-spacing: -2px; }
.logo span { color: var(--pink); text-shadow: 0 0 25px rgba(255, 79, 216, 0.5); }
.subtitle { font-size: 11px; font-weight: 900; letter-spacing: 3px; margin-top: 8px; color: #00ffcc; text-transform: uppercase; }

.vault-trigger { 
    position: absolute; right: 20px; top: 30px; background: var(--glass); border: 0.8px solid var(--border);
    padding: 10px 18px; border-radius: 40px; font-size: 10px; font-weight: 900; cursor: pointer;
}
.glow-badge { background: var(--pink); color: #000; font-size: 10px; padding: 2px 8px; border-radius: 10px; margin-left: 6px; box-shadow: 0 0 15px var(--pink); display: none; }

.container { max-width: 600px; margin: 20px auto; padding: 0 20px 150px; }
.liquid-card { 
    background: var(--glass); backdrop-filter: blur(60px); -webkit-backdrop-filter: blur(60px);
    border: 0.8px solid var(--border); border-radius: 35px; margin-bottom: 25px; 
    box-shadow: 0 25px 50px rgba(0,0,0,0.4);
}
.composer { padding: 30px; }
textarea { 
    width: 100%; background: rgba(0,0,0,0.4); border: 0.8px solid var(--border); 
    border-radius: 25px; padding: 22px; color: #fff; font-size: 18px; outline: none; margin-bottom: 20px; resize: none;
}
.btn-row { display: flex; gap: 15px; }
.btn { 
    flex: 1; padding: 20px; border-radius: 28px; font-weight: 900; font-size: 15px; 
    cursor: pointer; border: none; display: flex; align-items: center; justify-content: center; transition: 0.3s;
}
.btn-media { background: rgba(255,255,255,0.08); color: #fff; border: 0.8px solid var(--border); }
.btn-drop { background: linear-gradient(135deg, var(--pink), var(--hot)); color: #fff; box-shadow: 0 10px 30px rgba(255,79,216,0.3); }
.btn:active { transform: scale(0.92); }

.post-item { padding: 30px; cursor: pointer; }
.avatar { width: 45px; height: 45px; border-radius: 50%; border: 2px solid var(--pink); display: flex; align-items: center; justify-content: center; color: var(--pink); font-weight: 900; margin-bottom: 20px; background: #000; }
#spottedGlow { background: #00ff88; color: #000; padding: 4px 12px; border-radius: 20px; font-size: 10px; font-weight: 900; box-shadow: 0 0 20px #00ff88; margin-left: 15px; display: none; }
.v-tag { position: fixed; bottom: 20px; right: 20px; font-size: 10px; opacity: 0.4; font-weight: 900; }

#prevBox { display: none; margin-bottom: 20px; border-radius: 25px; overflow: hidden; border: 1px solid var(--pink); }
</style>
</head>
<body>

<header>
    <div class="vault-trigger" onclick="document.getElementById('auth').style.display='flex'">VAULT <span id="vBadge" class="glow-badge">0</span></div>
    <div class="logo">xoxo <span>gossip girl</span></div>
    <div class="subtitle">happy christmas ðŸŽ„</div>
</header>

<div class="container">
    <div class="liquid-card composer">
        <div id="prevBox"><img id="imgP" style="width:100%;"><p onclick="clearMedia()" style="color:var(--pink); text-align:center; padding:15px; font-weight:900; cursor:pointer; font-size:12px;">REMOVE PHOTO</p></div>
        <textarea id="tipIn" placeholder="I see everything..."></textarea>
        <input type="file" id="fileIn" accept="image/*" style="display:none" onchange="processMedia(this)">
        <div class="btn-row">
            <button class="btn btn-media" onclick="document.getElementById('fileIn').click()">MEDIA</button>
            <button class="btn btn-drop" id="dropBtn">DROP TIP</button>
        </div>
    </div>
    <h2 style="margin: 45px 0 25px 10px; font-size: 30px; font-weight: 900; display: flex; align-items: center;">Spotted! <span id="spottedGlow">NEW</span></h2>
    <div id="feed"></div>
</div>

<div id="auth" style="position:fixed; inset:0; background:rgba(0,0,0,0.95); backdrop-filter:blur(50px); z-index:3000; display:none; align-items:center; justify-content:center; padding:20px;">
    <div class="liquid-card" style="padding: 45px; text-align: center; width: 340px;">
        <h2 style="margin-bottom:25px; font-weight:900;">Identity</h2>
        <input type="password" id="pass" style="width:100%; padding:20px; border-radius:20px; background:#000; border:1px solid #333; color:#fff; text-align:center; margin-bottom:25px; outline:none; font-size:24px;">
        <button class="btn btn-drop" style="width:100%" onclick="login()">UNLOCK</button>
    </div>
</div>

<div class="v-tag">v2.5</div>

<script>
const firebaseConfig = { 
    apiKey: "AIzaSyCTdVcJspQxXiq_Kd7ImL32xWsjv0HgENE", 
    authDomain: "gossip-girl-4c9f2.firebaseapp.com", 
    projectId: "gossip-girl-4c9f2", 
    databaseURL: "https://gossip-girl-4c9f2-default-rtdb.firebaseio.com" 
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();
let b64 = null;

function processMedia(input) {
    if (input.files && input.files[0]) {
        const r = new FileReader();
        r.onload = e => {
            const img = new Image(); img.src = e.target.result;
            img.onload = () => {
                const cvs = document.createElement('canvas');
                const max = 700; let w = img.width, h = img.height;
                if(w > max) { h *= max/w; w = max; }
                cvs.width = w; cvs.height = h;
                cvs.getContext('2d').drawImage(img,0,0,w,h);
                b64 = cvs.toDataURL('image/jpeg', 0.6);
                document.getElementById('imgP').src = b64;
                document.getElementById('prevBox').style.display = 'block';
            };
        };
        r.readAsDataURL(input.files[0]);
    }
}
function clearMedia() { b64 = null; document.getElementById('prevBox').style.display='none'; }

document.getElementById('dropBtn').onclick = function() {
    const val = document.getElementById('tipIn').value.trim();
    if(!val && !b64) return;
    
    this.innerText = "SENDING..."; this.disabled = true;

    db.ref('tips').push({
        text: val,
        image: b64,
        date: Date.now()
    }).then(() => {
        document.getElementById('tipIn').value = '';
        clearMedia();
        this.innerText = "DROP TIP"; this.disabled = false;
        alert('Spotted! Your tip is in the vault. ðŸ’‹');
    }).catch((err) => {
        this.innerText = "DROP TIP"; this.disabled = false;
        alert("Error: " + err.message);
    });
};

db.ref('tips').on('value', s => {
    const n = s.numChildren();
    document.getElementById('vBadge').innerText = n;
    document.getElementById('vBadge').style.display = n > 0 ? 'inline-block' : 'none';
});

let oldC = localStorage.getItem('oldC') || 0;
db.ref('posts').on('value', s => {
    const feed = document.getElementById('feed'); feed.innerHTML = '';
    const data = s.val(); 
    if(data) {
        const keys = Object.keys(data).reverse();
        if(keys.length > oldC && oldC > 0) document.getElementById('spottedGlow').style.display = 'inline-block';
        keys.forEach(k => {
            const p = data[k];
            const div = document.createElement('div'); div.className = 'liquid-card post-item';
            div.onclick = () => { localStorage.setItem('currentPostId', k); location.href='comments.html'; };
            let img = p.image ? `<img src="${p.image}" style="width:100%; border-radius:25px; margin-bottom:20px; border:0.5px solid var(--border);">` : '';
            div.innerHTML = `<div class="avatar">?</div>${img}<div style="font-size:19px; line-height:1.6;">${p.text}</div>`;
            feed.appendChild(div);
        });
        localStorage.setItem('oldC', keys.length);
    }
});

function login() { if(document.getElementById('pass').value==='ykuluvmexoxogg2026xxx'){sessionStorage.setItem('admin_auth','true'); location.href='received-tips.html';}else{alert('Denied.');}}
</script>
</body>
</html>
