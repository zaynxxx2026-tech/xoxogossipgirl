<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Conversation</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
<link rel="stylesheet" href="https://fonts.cdnfonts.com/css/sf-pro-display">
<style>
body { background: #050505; color: #fff; font-family: 'SF Pro Display', sans-serif; padding: 20px; }
.card { background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 30px; padding: 25px; margin-bottom: 20px; }
.input-bar { position: fixed; bottom: 20px; left: 10px; right: 10px; background: rgba(20,20,20,0.9); border-radius: 50px; padding: 8px; display: flex; border: 1px solid rgba(255,255,255,0.1); }
input { flex:1; background:transparent; border:none; color:#fff; padding:0 15px; outline:none; }
.send { background:#ff4fd8; color:#000; border:none; padding:12px 20px; border-radius:40px; font-weight:900; }
.v-tag { position: fixed; bottom: 80px; right: 20px; font-size: 10px; opacity: 0.3; font-weight: 900; pointer-events:none; }
</style>
</head>
<body>
    <a href="index.html" style="color:#ff4fd8; text-decoration:none; font-weight:900;"> BACK</a>
    <div id="postAnchor" style="margin-top:20px;"></div>
    <div id="comments" style="margin-top:20px; padding-bottom:100px;"></div>
    <div class="input-bar"><input type="text" id="msg" placeholder="Comment..."><button class="send" id="send">SEND</button></div>
    <div class="v-tag">BUILD v2.5</div>
<script>
const firebaseConfig = { apiKey: "AIzaSyCTdVcJspQxXiq_Kd7ImL32xWsjv0HgENE", authDomain: "gossip-girl-4c9f2.firebaseapp.com", projectId: "gossip-girl-4c9f2", storageBucket: "gossip-girl-4c9f2.firebasestorage.app", messagingSenderId: "206020058212", appId: "1:206020058212:web:fb7c70aa1e3765e6691371" };
firebase.initializeApp(firebaseConfig);
const db = firebase.database();
const pid = localStorage.getItem('currentPostId');

db.ref('posts/' + pid).on('value', s => {
    const p = s.val(); if(p) document.getElementById('postAnchor').innerHTML = `<div class="card" style="font-size:19px;">${p.text}</div>`;
});

db.ref('comments/' + pid).on('value', s => {
    const list = document.getElementById('comments'); list.innerHTML = '';
    const data = s.val(); if(data) Object.keys(data).forEach(k => {
        const d = document.createElement('div'); d.style.padding='15px'; d.style.borderBottom='1px solid #222';
        d.innerHTML = `<small style="color:#ff4fd8; font-weight:900;">USER_${k.slice(-4)}</small><p>${data[k].text}</p>`;
        list.appendChild(d);
    });
});

document.getElementById('send').onclick = () => {
    const m = document.getElementById('msg').value;
    if(m) db.ref('comments/'+pid).push({ text:m, date:Date.now() }).then(() => document.getElementById('msg').value='');
};
</script>
</body>
</html>
