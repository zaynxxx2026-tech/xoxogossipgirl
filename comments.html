<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>XOXO Gossip Girl - Comments</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="https://fonts.cdnfonts.com/css/sf-pro-display">
<style>
:root{
  --pink:#ff4fd8;
  --hot:#ff1aa6;
  --bg:#0c0812;
  --glass:rgba(255,255,255,.06);
  --highlight:rgba(255,79,216,.6);
}

*{box-sizing:border-box;margin:0;padding:0;font-family:'SF Pro Display','SF Arabic',system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;}

body{
  background:radial-gradient(900px 500px at 10% 10%, #2b1445, transparent),
             radial-gradient(900px 500px at 90% 20%, #1b2c5a, transparent),
             var(--bg);
  color:white;
  min-height:100vh;
}

header{
  position:sticky;top:0;z-index:10;
  backdrop-filter:blur(14px);
  background:linear-gradient(90deg,rgba(255,79,216,.25),rgba(207,210,255,.15));
  border-bottom:1px solid rgba(255,255,255,.12);
  padding:14px;
  text-align:center;
}

.logo{font-weight:900;letter-spacing:2px;font-size:22px;text-shadow:0 0 14px var(--pink);}
.logo span{color:var(--pink);}
.subtitle{font-size:14px;opacity:.6;margin-top:2px;}

.wrap{max-width:640px;margin:24px auto;padding:20px;display:flex;flex-direction:column;gap:20px;}

.tip-card{
  background:linear-gradient(180deg,var(--glass),transparent);
  padding:20px;
  border-radius:22px;
  box-shadow:0 10px 40px rgba(255,26,166,.35);
  position:relative;
}

.tip-card img{max-width:100%;border-radius:18px;margin-top:12px;transition:transform .25s;cursor:pointer;}
.tip-card img:hover{transform:scale(1.05);}

.tip-info{opacity:.6;font-size:12px;margin-top:6px;}

.comments-section{display:flex;flex-direction:column;gap:12px;}

.comment-input{width:100%;padding:14px;border-radius:16px;border:none;background:#1f1433;color:white;font-family:'SF Pro Display','SF Arabic',system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;}

.comment-btn{margin-top:6px;align-self:flex-start;border:none;border-radius:999px;padding:10px 18px;font-weight:700;background:linear-gradient(135deg,var(--pink),var(--hot));cursor:pointer;}

.comment-bubble{
  background:linear-gradient(180deg,var(--glass),transparent);
  padding:12px;border-radius:18px;
  display:flex;align-items:flex-start;gap:10px;
  box-shadow:0 6px 20px rgba(255,26,166,.3);
  transition:transform .25s;
}

.comment-bubble:hover{transform:translateY(-2px);box-shadow:0 10px 25px var(--highlight);}

.comment-avatar{width:36px;height:36px;background:rgba(255,255,255,.15);border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:bold;font-size:18px;}

.comment-content{display:flex;flex-direction:column;gap:4px;}
.comment-name{font-size:12px;opacity:.6;}

.reaction-btns{display:flex;gap:6px;margin-top:6px;}
.reaction-btn{padding:6px 10px;border:none;border-radius:999px;cursor:pointer;background:rgba(255,26,166,.2);transition:.2s;font-size:14px;}
.reaction-btn:hover{transform:scale(1.1);background:linear-gradient(135deg,var(--pink),var(--hot));color:#000;}

.back-btn{margin-top:10px;align-self:center;border:none;border-radius:999px;padding:10px 18px;font-weight:700;background:linear-gradient(135deg,var(--pink),var(--hot));cursor:pointer;}
.version{position:fixed;bottom:10px;right:12px;font-size:12px;opacity:.5;font-style:italic;}
</style>
</head>

<body>
<header>
  <div class="logo">XOXO <span>Gossip Girl</span></div>
  <div class="subtitle">happy christmas </div>
</header>

<div class="wrap">
  <div class="tip-card">
    <div id="tipText"></div>
    <img id="tipImg" hidden>
    <div id="tipInfo" class="tip-info"></div>
  </div>

  <div class="comments-section">
    <input type="text" id="commentInput" class="comment-input" placeholder="what do you have in mind?">
    <button id="sendComment" class="comment-btn">Send</button>
    <div id="commentList"></div>
  </div>

  <button class="back-btn" onclick="location.href='index.html'">Back Home</button>
</div>

<div class="version">v1.2</div>

<script>
const FEED_KEY='xoxo_feed_v2';
const COMMENT_KEY='xoxo_comments';

let feed = JSON.parse(localStorage.getItem(FEED_KEY)||'[]');
let comments = JSON.parse(localStorage.getItem(COMMENT_KEY)||'{}');

const currentIndex = parseInt(localStorage.getItem('currentPost'));
const post = feed[currentIndex];

const tipText = document.getElementById('tipText');
const tipImg = document.getElementById('tipImg');
const tipInfo = document.getElementById('tipInfo');
const commentInput = document.getElementById('commentInput');
const commentList = document.getElementById('commentList');

if(!post){
  tipText.textContent='This gossip no longer exists.';
} else {
  tipText.textContent=post.text||'';
  if(post.image){tipImg.src=post.image; tipImg.hidden=false;}

  let viewedTips = JSON.parse(localStorage.getItem('viewedTips')||'[]');
  if(!viewedTips.includes(currentIndex)){
    post.views=(post.views||0)+1;
    feed[currentIndex]=post;
    localStorage.setItem(FEED_KEY,JSON.stringify(feed));
    viewedTips.push(currentIndex);
    localStorage.setItem('viewedTips',JSON.stringify(viewedTips));
  }

  const date=new Date(post.time||Date.now());
  tipInfo.textContent=`${post.views||0} views • ${date.toLocaleString()}`;
}

// Render comments
function renderComments(){
  commentList.innerHTML='';
  const arr=comments[currentIndex]||[];
  if(arr.length===0){commentList.innerHTML='<p style="opacity:.4">Be the first to comment…</p>';}
  else{
    arr.slice().reverse().forEach(c=>{
      const div=document.createElement('div'); div.className='comment-bubble';
      div.innerHTML=`<div class="comment-avatar">?</div>
                       <div class="comment-content">
                         <div class="comment-name">Anonymous User</div>
                         <div>${c.text}</div>
                         <div class="reaction-btns"></div>
                       </div>`;
      // Render reactions per comment
      const reactionDiv=div.querySelector('.reaction-btns');
      ['','','',''].forEach(emoji=>{
        const btn=document.createElement('button'); btn.className='reaction-btn'; btn.textContent=emoji+(c.reactions&&c.reactions[emoji]?` ${c.reactions[emoji]}`:'');
        btn.onclick=()=>{ if(!c.reactions) c.reactions={}; c.reactions[emoji]=(c.reactions[emoji]||0)+1; localStorage.setItem(COMMENT_KEY,JSON.stringify(comments)); renderComments(); };
        reactionDiv.appendChild(btn);
      });
      commentList.appendChild(div);
    });
  }
  // Auto-scroll to newest comment
  commentList.scroll({top:commentList.scrollHeight, behavior:'smooth'});
}

document.getElementById('sendComment').onclick=()=>{
  const txt=commentInput.value.trim();
  if(!txt) return;
  if(!comments[currentIndex]) comments[currentIndex]=[];
  comments[currentIndex].push({text:txt,reactions:{}});
  localStorage.setItem(COMMENT_KEY,JSON.stringify(comments));
  commentInput.value='';
  renderComments();
};

renderComments();
</script>

</body>
</html>