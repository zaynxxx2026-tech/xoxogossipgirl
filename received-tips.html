<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>The Vault</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
<link rel="stylesheet" href="https://fonts.cdnfonts.com/css/sf-pro-display">
<style>
body { background: #050505; color: #fff; font-family: 'SF Pro Display', sans-serif; padding: 20px; }
.card { background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 25px; padding: 25px; margin-bottom: 20px; }
.btn { padding: 15px; border-radius: 15px; border: none; font-weight: 800; cursor: pointer; width: 48%; }
.v-tag { position: fixed; bottom: 20px; right: 20px; font-size: 10px; opacity: 0.3; font-weight: 900; }
</style>
</head>
<body>
    <h2 style="margin-bottom:30px; text-align:center;">Pending Tips</h2>
    <div id="list" style="max-width:500px; margin:0 auto;"></div>
    <center><button onclick="location.href='index.html'" style="background:none; color:#ff4fd8; border:none; margin-top:20px; font-weight:900;">BACK TO FEED</button></center>
    <div class="v-tag">BUILD v2.5</div>
<script>
if (sessionStorage.getItem('admin_auth') !== 'true') location.href = 'index.html';
const firebaseConfig = { apiKey: "AIzaSyCTdVcJspQxXiq_Kd7ImL32xWsjv0HgENE", authDomain: "gossip-girl-4c9f2.firebaseapp.com", projectId: "gossip-girl-4c9f2", storageBucket: "gossip-girl-4c9f2.firebasestorage.app", messagingSenderId: "206020058212", appId: "1:206020058212:web:fb7c70aa1e3765e6691371" };
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

db.ref('tips').on('value', s => {
    const list = document.getElementById('list'); list.innerHTML = '';
    const data = s.val(); if(!data) return;
    Object.keys(data).forEach(id => {
        const div = document.createElement('div'); div.className = 'card';
        div.innerHTML = `<p style="margin-bottom:20px;">${data[id].text}</p>
            <div style="display:flex; justify-content:space-between;">
                <button class="btn" style="background:#333; color:#fff;" onclick="db.ref('tips/${id}').remove()">Burn</button>
                <button class="btn" style="background:#ff4fd8; color:#000;" onclick="publish('${id}','${data[id].text.replace(/'/g,"\\'")}')">Publish</button>
            </div>`;
        list.appendChild(div);
    });
});
function publish(id, txt) { db.ref('posts').push({ text: txt, date: Date.now() }).then(() => db.ref('tips/'+id).remove()); }
</script>
</body>
</html>
